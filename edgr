#!/usr/bin/perl

# todo:
# finish algorithm to calculate goal
# use more functions
# test goals
# add considerations for distance from mean / std dev
# add considerations for coin flips
# determine how failure and success should affect things

use strict;
use warnings;

use Edgr;
use Getopt::Long;

my $config      = "$ENV{HOME}/.config/edgr";
my $settings    = read_config($config);

read_settings($settings);

# Check if a session is allowed
if (deny_play($settings)) {
  exit;
}

my $session     = init_session($settings);

while ($$session{time_max} > $$session{duration}) {
  make_beats($session);
}

write_script($session);
play_script($session);
save_session($session);

score_sessions($session,$$session{sessions_owed});
